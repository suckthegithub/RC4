 enc and dec in the same function
